

### Основные сущности

#### 1. Catalog_Номенклатура

Сущность содержит информацию о номенклатуре товаров.

##### Поля:

| Поле | Тип | Описание |
|------|-----|----------|
| Ref_Key | GUID | Уникальный идентификатор номенклатуры |
| Code | Строка | Код номенклатуры |
| Description | Строка | Наименование номенклатуры |
| Артикул | Строка | Артикул изделия |
| СпособПополнения | Строка | Способ пополнения (Закупка, Производство и т.д.) |
| СрокПополнения | Число | Срок пополнения в днях |
| ЕдиницаИзмерения_Key | GUID | Ссылка на единицу измерения |
| КатегорияНоменклатуры_Key | GUID | Ссылка на категорию номенклатуры |
| ТипНоменклатуры | Строка | Тип номенклатуры (Запас, Услуга и т.д.) |

#### 1.1. Catalog_КатегорииНоменклатуры

Сущность содержит информацию о категориях номенклатуры. Вся иерархия категорий номенклатуры хранится в одном справочнике.
Поле IsFolder разделяет два типа элементов:
- IsFolder: true - "Группы категорий номенклатуры" (папки)
- IsFolder: false - "Категории номенклатуры" (конечные категории)

##### Поля:

| Поле | Тип | Описание |
|------|-----|----------|
| Ref_Key | GUID | Уникальный идентификатор категории |
| Code | Строка | Код категории |
| Description | Строка | Наименование категории |
| Parent_Key | GUID | Ссылка на родительскую категорию |
| IsFolder | Булево | Признак группы категорий (true - группа, false - категория) |
| Predefined | Булево | Признак предопределенной категории |
| PredefinedDataName | Строка | Имя предопределенной категории |
| DataVersion | Строка | Версия данных |
| DeletionMark | Булево | Признак удаления |

#### 3. AccumulationRegister_ЗапасыНаСкладах

Сущность содержит информацию об остатках на складах.

ВНИМАНИЕ: Остатки читаются через ресурс регистра "Остатки" (Balance), а не через набор записей регистра.
Пример запроса к остатку:
- GET {base}/AccumulationRegister_ЗапасыНаСкладах/Balance?$select=Номенклатура_Key,Склад_Key,КоличествоОстаток&$top=5

Для получения полей номенклатуры по ссылкам (код/наименование/артикул) используйте $expand или отдельный батч‑запрос к Catalog_Номенклатура.

##### Поля (ресурс Остатки/Balance):

| Поле | Тип | Описание |
|------|-----|----------|
| Номенклатура_Key | GUID | Ссылка на номенклатуру |
| Склад_Key | GUID | Ссылка на склад |
| КоличествоОстаток | Число | Остаток количества |
| Номенклатура/Code | Строка | Код номенклатуры (через расширение) |
| Номенклатура/Description | Строка | Наименование номенклатуры (через расширение) |
| Номенклатура/Артикул | Строка | Артикул номенклатуры (через расширение) |

Примечание: если обращаться к базовому набору регистра без ресурса остатков, сервер вернёт движения с полями RecordSet/Recorder, а не срез остатков.

#### 4. Catalog_Спецификации

Сущность содержит информацию о спецификациях изделий, включая состав и операции.

Примечание: детальные строки состава и операций доступны отдельными наборами:
- Catalog_Спецификации_Состав — строки состава (компоненты),
- Catalog_Спецификации_Операции — строки операций.
В самой Catalog_Спецификации поля "Состав" и "Операции" представлены как навигации.

##### Поля:

| Поле | Тип | Описание |
|------|-----|----------|
| Ref_Key | GUID | Уникальный идентификатор спецификации |
| Code | Строка | Код спецификации |
| Description | Строка | Наименование спецификации |
| Состав | Массив | Состав спецификации (номенклатура, количество, этапы) |
| Операции | Массив | Операции по производству |

##### Поля состава:

| Поле | Тип | Описание |
|------|-----|----------|
| Номенклатура_Key | GUID | Ссылка на номенклатуру компонента |
| Количество | Число | Количество компонента |
| Этап_Key | GUID | Ссылка на этап производства |
| ТипСтрокиСостава | Строка | Тип строки (Материал, Сборка) |

##### Поля операций:

| Поле | Тип | Описание |
|------|-----|----------|
| Операция_Key | GUID | Ссылка на операцию |
| НормаВремени | Число | Норма времени на операцию |
| Этап_Key | GUID | Ссылка на этап производства |

#### 5. Document_ЗаказНаПроизводство

Сущность содержит информацию о заказах на производство.

##### Поля:

| Поле | Тип | Описание |
|------|-----|----------|
| Ref_Key | GUID | Уникальный идентификатор заказа |
| Number | Строка | Номер заказа |
| Date | Дата | Дата заказа |
| Posted | Булево | Проведен ли документ |
| Продукция | Массив | Список продукции для производства |
| Запасы | Массив | Список запасов (компонентов) |
| Операции | Массив | Операции по производству |

##### Поля продукции:

| Поле | Тип | Описание |
|------|-----|----------|
| Номенклатура_Key | GUID | Ссылка на номенклатуру продукции |
| Количество | Число | Количество продукции |
| Спецификация_Key | GUID | Ссылка на спецификацию |
| Этап_Key | GUID | Ссылка на этап производства (опционально) |

##### Поля запасов (компонентов):

| Поле | Тип | Описание |
|------|-----|----------|
| Номенклатура_Key | GUID | Ссылка на номенклатуру компонента |
| Количество | Число | Количество компонента |
| Спецификация_Key | GUID | Ссылка на спецификацию |
| Этап_Key | GUID | Ссылка на этап производства |

##### Поля операций:

| Поле | Тип | Описание |
|------|-----|----------|
| Операция_Key | GUID | Ссылка на операцию |
| КоличествоПлан | Число | Планируемое количество |
| НормаВремени | Число | Норма времени на операцию |
| Нормочасы | Число | Нормочасы |
| Этап_Key | GUID | Ссылка на этап производства |

#### 6. Document_ЗаказПоставщику

Сущность содержит информацию о заказах поставщикам.

##### Поля:

| Поле | Тип | Описание |
|------|-----|----------|
| Ref_Key | GUID | Уникальный идентификатор заказа |
| Number | Строка | Номер заказа |
| Date | Дата | Дата заказа |
| Posted | Булево | Проведен ли документ |
| Контрагент_Key | GUID | Ссылка на контрагента (поставщика) |
| СуммаДокумента | Число | Сумма документа |
| Запасы | Массив | Список запасов (номенклатуры) в заказе |

##### Поля запасов (номенклатуры в заказе):

| Поле | Тип | Описание |
|------|-----|----------|
| Номенклатура_Key | GUID | Ссылка на номенклатуру |
| Количество | Число | Количество номенклатуры |
| Цена | Число | Цена номенклатуры |
| Сумма | Число | Сумма позиции |
| ДатаПоступления | Дата | Планируемая дата поступления |

#### 7. InformationRegister_СпецификацииПоУмолчанию

Сущность содержит информацию о спецификациях по умолчанию для номенклатуры.

##### Поля:

| Поле | Тип | Описание |
|------|-----|----------|
| Номенклатура_Key | GUID | Ссылка на номенклатуру |
| Характеристика_Key | GUID | Ссылка на характеристику |
| Спецификация_Key | GUID | Ссылка на спецификацию по умолчанию |

### Сопоставление с собственной базой данных

#### Таблица items (номенклатура)

| Поле 1С | Поле нашей БД | Описание |
|---------|---------------|----------|
| Ref_Key | item_ref1c | GUID 1С (уникальный идентификатор номенклатуры) |
| Code | item_code | Код номенклатуры |
| Description | item_name | Наименование номенклатуры |
| Артикул | item_article | Артикул изделия |
| СпособПополнения | replenishment_method | Способ пополнения |
| СрокПополнения | replenishment_time | Срок пополнения в днях |

#### Таблица stock (остатки)

| Поле 1С | Поле нашей БД | Описание |
|---------------|----------|
| Номенклатура_Key | item_id | Ссылка на номенклатуру |
| Склад_Key | warehouse_id | Ссылка на склад |
| КоличествоОстаток | quantity | Остаток количества |

#### Таблица specifications (спецификации)

| Поле 1С | Поле нашей БД | Описание |
|---------|---------------|----------|
| Ref_Key | spec_id | Уникальный идентификатор спецификации |
| Code | spec_code | Код спецификации |
| Description | spec_name | Наименование спецификации |

#### Таблица spec_components (компоненты спецификаций)

| Поле 1С | Поле нашей БД | Описание |
|---------|---------------|----------|
| Номенклатура_Key (в составе) | component_item_id | Ссылка на номенклатуру компонента |
| Номенклатура_Key (владелец) | parent_item_id | Ссылка на номенклатуру изделия |
| Количество | quantity | Количество компонента |
| Этап_Key | stage_id | Ссылка на этап производства |
| ТипСтрокиСостава | component_type | Тип компонента (Материал, Сборка) |

#### Таблица operations (операции)

| Поле 1С | Поле нашей БД | Описание |
|---------|---------------|----------|
| Операция_Key | operation_id | Уникальный идентификатор операции |
| НормаВремени | time_norm | Норма времени на операцию |
| Этап_Key | stage_id | Ссылка на этап производства |

#### Таблица production_orders (заказы на производство)

| Поле 1С | Поле нашей БД | Описание |
|---------|---------------|----------|
| Ref_Key | order_id | Уникальный идентификатор заказа |
| Number | order_number | Номер заказа |
| Date | order_date | Дата заказа |
| Posted | is_posted | Проведен ли документ |

#### Таблица production_products (продукция в заказах)

| Поле 1С | Поле нашей БД | Описание |
|---------|---------------|----------|
| Номенклатура_Key | item_id | Ссылка на номенклатуру продукции |
| Количество | quantity | Количество продукции |
| Спецификация_Key | spec_id | Ссылка на спецификацию |
| Этап_Key | stage_id | Ссылка на этап производства |

#### Таблица production_components (компоненты в заказах)

| Поле 1С | Поле нашей БД | Описание |
|---------|---------------|----------|
| Номенклатура_Key | item_id | Ссылка на номенклатуру компонента |
| Количество | quantity | Количество компонента |
| Спецификация_Key | spec_id | Ссылка на спецификацию |
| Этап_Key | stage_id | Ссылка на этап производства |

#### Таблица production_operations (операции в заказах)

| Поле 1С | Поле нашей БД | Описание |
|---------|---------------|----------|
| Операция_Key | operation_id | Ссылка на операцию |
| КоличествоПлан | planned_quantity | Планируемое количество |
| НормаВремени | time_norm | Норма времени на операцию |
| Нормочасы | standard_hours | Нормочасы |
| Этап_Key | stage_id | Ссылка на этап производства |

#### Таблица supplier_orders (заказы поставщикам)

| Поле 1С | Поле нашей БД | Описание |
|---------|---------------|----------|
| Ref_Key | order_id | Уникальный идентификатор заказа |
| Number | order_number | Номер заказа |
| Date | order_date | Дата заказа |
| Posted | is_posted | Проведен ли документ |
| Контрагент_Key | supplier_id | Ссылка на контрагента (поставщика) |
| СуммаДокумента | document_amount | Сумма документа |

#### Таблица supplier_order_items (позиции в заказах поставщикам)

| Поле 1С | Поле нашей БД | Описание |
|---------|---------------|----------|
| Номенклатура_Key | item_id | Ссылка на номенклатуру |
| Количество | quantity | Количество номенклатуры |
| Цена | price | Цена номенклатуры |
| Сумма | amount | Сумма позиции |
| ДатаПоступления | delivery_date | Планируемая дата поступления |

#### Таблица default_specifications (спецификации по умолчанию)

| Поле 1С | Поле нашей БД | Описание |
|---------------|----------|
| Номенклатура_Key | item_id | Ссылка на номенклатуру |
| Характеристика_Key | characteristic_id | Ссылка на характеристику |
| Спецификация_Key | spec_id | Ссылка на спецификацию по умолчанию |

### Примечания

1. Для получения полной информации о номенклатуре может потребоваться использование $expand в запросах OData.
2. При синхронизации данных необходимо учитывать возможные различия в форматах данных между 1С и нашей базой.
3. Необходимо реализовать механизм обработки изменений в данных 1С для поддержания актуальности нашей базы.
4. Спецификации содержат сложную структуру с вложенными массивами, требующими особой обработки при импорте.
5. Заказы на производство содержат сложную структуру с несколькими вложенными массивами (продукция, запасы, операции), требующими особой обработки при импорте.
6. Заказы поставщикам содержат информацию о закупаемой номенклатуре, количествах, ценах и сроках поставки.
7. Регистр сведений "Спецификации по умолчанию" используется для определения актуальной спецификации изделия при поиске спецификации.

